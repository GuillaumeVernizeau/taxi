#!./.venv/bin/python3

from src import parse_args
from src.bruteforce import BruteforceMultiple
from src.qtable import qtable
from src.optimizer import Optimizer
from src.taxi_dqn import run_deep_q, train_on_multiple_maps  # ‚¨ÖÔ∏è ajout de l'import
import glob

def entrypoint():
    args = parse_args()

    if args.optimize_with_bayesian or args.optimize_with_variations:
        print("üîç Mode optimisation activ√© !")
        optimizer = Optimizer(base_params=args)
        best_params = optimizer.optimize()
        print("\nüöÄ Entra√Ænement final avec les meilleurs param√®tres trouv√©s...")
        qtable(best_params)

    elif args.bruteforce:
        bruteforce = BruteforceMultiple(args, 100, "human")
        bruteforce.launch()

    elif args.deep_q:
        # Si aucune carte pr√©cis√©e, on entra√Æne sur toutes les maps disponibles
        if args.map_path is None and not args.skipTraining:
            print("üåê Entra√Ænement sur toutes les cartes .map disponibles‚Ä¶")
            maps = sorted(glob.glob("maps/*.map"))  # ‚úÖ r√©cup√®re tous les fichiers .map
            train_on_multiple_maps(maps, args.training_episodes, args)
        else:
            run_deep_q(args)


    else:
        qtable(args)

if __name__ == "__main__":
    entrypoint()
